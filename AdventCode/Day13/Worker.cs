using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using static AdventCode.Day13.Enums;

namespace AdventCode.Day13
{
    public class Worker
    {
        private List<Track> _tracks = new List<Track>();

        private List<Cart> _carts = new List<Cart>();

        public Worker()
        {
            var splits = _input.Split(new[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries);

            int y = 0;
            foreach (string split in splits)
            {
                for (int x = 0; x < split.Length; x++)
                {
                    Track track;
                    switch (split[x])
                    {
                        case '|':
                            track = new Track(x, y);
                            AddUp(y, x, track);
                            AddDown(y, x, track);
                            _tracks.Add(track);
                            break;
                        case '-':
                            track = new Track(x, y);
                            AddLeft(y, x, track);
                            AddRight(y, x, track);
                            _tracks.Add(track);
                            break;
                        case '/':
                            track = new Track(x, y);
                            if (x + 1 < split.Length && (split[x + 1] == '-' || split[x + 1] == '+' || split[x + 1] == '<' || split[x + 1] == '>'))
                            {
                                AddRight(y, x, track);
                                AddDown(y, x, track);
                            }
                            else if (x - 1 >= 0 && (split[x - 1] == '-' || split[x - 1] == '+' || split[x - 1] == '<' || split[x - 1] == '>'))
                            {
                                AddUp(y, x, track);
                                AddLeft(y, x, track);
                            }                               
                            _tracks.Add(track);
                            break;
                        case '\\':
                            track = new Track(x, y);
                            if (x + 1 < split.Length && (split[x + 1] == '-' || split[x + 1] == '+' || split[x + 1] == '<' || split[x + 1] == '>'))
                            {
                                AddUp(y, x, track);
                                AddRight(y, x, track);
                            }
                            else if (x - 1 >= 0 && (split[x - 1] == '-' || split[x - 1] == '+' || split[x - 1] == '<' || split[x - 1] == '>'))
                            {
                                AddDown(y, x, track);
                                AddLeft(y, x, track);
                            }
                            _tracks.Add(track);
                            break;
                        case '+':
                            track = new Track(x, y);
                            track.IsIntersection = true;
                            AddUp(y, x, track);
                            AddDown(y, x, track);
                            AddLeft(y, x, track);
                            AddRight(y, x, track);
                            _tracks.Add(track);
                            break;
                        case '>':
                            track = new Track(x, y);
                            AddLeft(y, x, track);
                            AddRight(y, x, track);
                            _tracks.Add(track);
                            _carts.Add(new Cart(track, Direction.Right));
                            break;
                        case '<':
                            track = new Track(x, y);
                            AddLeft(y, x, track);
                            AddRight(y, x, track);
                            _tracks.Add(track);
                            _carts.Add(new Cart(track, Direction.Left));
                            break;
                        case '^':
                            track = new Track(x, y);
                            AddUp(y, x, track);
                            AddDown(y, x, track);
                            _tracks.Add(track);
                            _carts.Add(new Cart(track, Direction.Up));
                            break;
                        case 'v':
                            track = new Track(x, y);
                            AddUp(y, x, track);
                            AddDown(y, x, track);
                            _tracks.Add(track);
                            _carts.Add(new Cart(track, Direction.Down));
                            break;
                        case ' ':
                            break;
                        default:
                            throw new Exception("This should never happen.");
                    }
                }

                y++;
            }
        }

        public string Work1()
        {
            string output = string.Empty;

            int i = 1;
            while (string.IsNullOrEmpty(output))
            {
                var orderedCarts = _carts.OrderBy(c => c.CurrentTrack.Y).ThenBy(c => c.CurrentTrack.X);
                foreach (Cart cart in orderedCarts)
                {
                    cart.Move();

                    if (_carts.GroupBy(c => c.CurrentTrack).Any(g => g.Count() > 1))
                    {
                        output = $"{cart.CurrentTrack.X},{cart.CurrentTrack.Y}";
                        break;
                    }
                }
                i++;
            }

            return output;
        }

        public string Work2()
        {
            int i = 1;
            while (_carts.Count > 1)
            {
                var orderedCarts = _carts.OrderBy(c => c.CurrentTrack.Y).ThenBy(c => c.CurrentTrack.X);
                foreach (Cart cart in orderedCarts)
                {
                    cart.Move();

                    var group = _carts.GroupBy(c => c.CurrentTrack).FirstOrDefault(g => g.Count() > 1);
                    if (group != null)
                    {
                        foreach (var crashing in group.Select(x => x))
                        {
                            _carts.Remove(crashing);
                        }
                    }
                }
                i++;
            }

            return $"{_carts[0].CurrentTrack.X},{_carts[0].CurrentTrack.Y}";
        }

        private void AddRight(int y, int x, Track track)
        {
            Track right = _tracks.FirstOrDefault(t => t.X == x + 1 && t.Y == y);
            track.Right = right;
            if (right != null)
                right.Left = track;
        }

        private void AddLeft(int y, int x, Track track)
        {
            Track left = _tracks.FirstOrDefault(t => t.X == x - 1 && t.Y == y);
            track.Left = left;
            if (left != null)
                left.Right = track;
        }

        private void AddDown(int y, int x, Track track)
        {
            Track down = _tracks.FirstOrDefault(t => t.X == x && t.Y == y + 1);
            track.Down = down;
            if (down != null)
                down.Up = track;
        }

        private void AddUp(int y, int x, Track track)
        {
            Track up = _tracks.FirstOrDefault(t => t.X == x && t.Y == y - 1);
            track.Up = up;
            if (up != null)
                up.Down = track;
        }

        string _testInput = @"/->-\        
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   ";

        string _input = @"                                               /---------\                                                                                            
                                               |         |/---------------\                                                                           
        /--------------------------------------+---------++---------------+-----------------------------\                                             
        |                      /---------------+---------++-------------<-+----------------------------\|                                             
   /----+----------------------+------\        |         ||               |                            ||                                             
   |    |                      |      |        |         ||               |                            ||  /-------------------------------------\    
   |    |                      |      |        |         ||               |                            ||  |                                     |    
   |    |    /-----------------+------+--------+---------++---------------+-------\              /-----++--+-------------------------------------+-\  
   |    |    |        /--------+------+--------+---------++-------------\ |       |              |     ||  |                           /---------+\|  
   |    |    |        |        |      |        |         ||        /----+-+-------+--------------+-\  /++--+---------------------------+---------+++\ 
   |    |    |    /---+--------+------+--------+-----\   ||      /-+----+-+-------+--------------+-+--+++--+-----------\               |         |||| 
   |    |    |    |   |        |      |        |     |   ||      | |    | |       |              | |  |||  |           |               |         |||| 
   |    |    |    |  /+--------+------+--------+---\ |   ||      | |    | |       |              | |  |||  |           |               |         |||| 
   |    |    |    |  ||        |      |        |   | |   ||      | |    | |       | /------------+-+--+++--+------\    |               |         |||| 
   |    |    |/---+--++--------+-----\|        | /-+-+---++------+-+----+-+-----\/+-+------------+-+--+++--+------+----+-\             |         |||| 
   |    |   /++---+--++--------+-----++--\     | | | |   ||      | |    | |     |||/+------------+-+--+++--+------+----+-+-------------+---------++++\
   |    |   |||   |  ||  /-----+-----++--+-----+-+-+-+---++-\    | |    | |     |||||         /--+-+--+++--+------+----+-+-------------+------\  |||||
   | /--+---+++---+--++--+-----+-----++--+-----+-+-+-+---++-+----+-+----+-+-----+++++-------\ |  | |  |||  |      |    | |             \-<----+--+/|||
   | |/-+---+++---+--++--+-----+--\  ||  |     | | | |   || |    | |    | |     |||||       | |  \-+--+++--+------+----+-+--------------------+--+-/||
   | || |   |||   |  ||  |     |  |  ||  |     | | | |   ||/+----+-+----+-+-----+++++-------+-+----+--+++--+------+----+-+--------------\     |  |  ||
   | || |   |||   |  ||  |    /+--+--++--+-----+-+-+-+---++++----+-+----+-+-----+++++-------+-+----+--+++--+------+----+\|              |     |  |  ||
   | || |   |||   |  ||  |    ||  |  ||  |     | | | | /-++++----+-+----+-+-----+++++-------+-+----+--+++--+------+----+++----\         |     |  |  ||
   | || |   |||   |  ||/-+----++--+--++--+-----+-+-+-+-+-++++----+-+----+-+----\|||||       | |    |  \++--+------+----+++----+---------+-----+--+--/|
   | || |   |||   \--+++-+----++--+--++--+-----+-+-+-/ | ||||    | |    | |/---++++++-------+-+----+---++--+------+----+++----+--------\|     |  |   |
   | || |   |||      ||| |    ||  |  ||  |     | | |   | |\++----+-+----+-/|   ||||||       | |    |   ||/-+------+\   |||    |        ||     |  |   |
   | || |   |||      ||| |    ||  |  ||  |     | | |   | | || /--+-+----+--+-\ ||||||       | |    |   ||| |      ||   |||    |        ||     |  |   |
   | || | /-+++------+++-+----++\ |  ||  |     | | |   | | || |  | |    | /+-+-++++++-------+-+----+---+++-+------++---+++----+--------++\    |  |   |
   | || | | |||      |\+-+----+++-+--++--+-----+-+-+---+-+-++-+--+-+----/ || | ||||||       | |    |   ||| |      ||   |||    |        |||    |  |   |
   | || | | |||      | | |    ||| |  ||  |     | | |   | | || |  | \------++-+-++++++-------+-+----/   ||| |      ||   |||    |        |||    |  |   |
   | || | | |||    /-+-+-+----+++-+--++--+-----+-+-+---+-+-++\|  |     /--++-+-++++++-------+-+--------+++-+----\ ||   |||    |        |||    |  |   |
   | || | | |||    | | | |    ||| |  ||  |     | | |   | | ||||  |     |  || | ||||||       | |   /----+++-+-\  | ||   |||    |        |||    |  |   |
   | || | | |||  /-+-+-+-+----+++-+--++--+-----+-+-+---+-+-++++--+-----+--++-+-++++++-------+-+---+----+++-+\|  | ||   |||    |        |||    |  |   |
   | || | | ||v  | v | | |    ||| |  ||  |     | | |   | | ||||  |     |  || | ||||||   /---+-+---+----+++-+++--+-++---+++----+-\      |||    |  |   |
   | || | | |||  | | | | |    ||| |  ||  |     | | | /-+-+-++++--+-----+--++-+-++++++---+---+-+---+----+++-+++--+-++---+++----+-+--\   |||    |  |   |
   | || | | |||  | | | | |    ||| |  ||  |     | | | | |/+-++++--+-----+--++-+-++++++---+---+-+---+----+++-+++--+-++---+++----+-+--+---+++----+--+\  |
   | || | | |||  | | | | |    ||| |  ||  |     | \-+-+-+++-++++--+-----+--++-+-+/||||   |   | \---+----+++-+++--+-++---+++----+-+--+---+++----/  ||  |
   | || | | |||  | | | | |    ||| |  ||  |     |   | | ||| |||| /+-----+--++-+-+-++++---+---+-----+----+++-+++--+-++---+++----+-+--+---+++----\  ||  |
   | || | | |||  | | | | |    ||| |  ||  |     |   | | ||| |||| ||    /+--++-+-+-++++---+---+-----+---\||| |||  |/++---+++----+-+--+\  |||    |  ||  |
   | || | | |||  | | | | |    |||/+--++--+\    |   | | ||| |||| ||    ||  || |/+-++++---+---+-----+---++++-+++--++++---+++----+-+--++--+++---\|  ||  |
/--+-++-+-+-+++--+-+-+-+-+----+++++\ ||  ||    |   | | ||| |||| ||    ||  || ||| ||||   | /-+-----+---++++-+++--++++---+++----+-+--++\ |||   ||  ||  |
|  | || | | |||  | | | | |    |||||| || /++----+---+-+-+++-++++-++----++--++-+++-++++---+-+-+-----+---++++-+++\ ||||   |||    | |  ||| |||   ||  ||  |
|  | || | | |||  | | | | |    |||||| || |||  /-+---+-+-+++-++++-++----++--++-+++-++++---+\| |     |   |||\-++++-+++/   |||/---+-+--+++-+++---++\ ||  |
|  | || | | |||  | | | | |    |||||| || |||  | |   | | ||| |||| ||    ||  || ||| ||||   ||| |     |   |||  |||| |||    ||||   | |  ||| |||   ||| ||  |
|  | ||/+-+-+++--+-+-+-+-+----++++++-++-+++\ | |  /+-+-+++-++++-++----++--++-+++-++++---+++-+-----+---+++--++++-+++----++++---+-+--+++-+++-\ ||| ||  |
| /+-++++-+-+++--+-+-+-+-+----++++++-++-++++-+-+--++-+-+++-++++-++---\||  || ||| ||||   ||| |     |   |||  |||| |||    ||||   | |  ||| ||| | ||| ||  |
| || |||| | |||  | | | | |    |||||| || ||||/+-+--++-+-+++-++++-++---+++--++-+++-++++---+++-+-----+---+++--++++-+++----++++---+-+--+++-+++-+\||| ||  |
| || |||| | |||  | | | | |    |||||| || |||||| |  || | ||| |||| ||   |||  || ||| ||||   ||| |     |   |||  |||| |||    ||^|   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| || |||||| |  || | |||/++++-++---+++--++-+++-++++--\||| |     |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| ||/++++++-+--++-+-++++++++-++---+++--++-+++-++++--++++-+--\  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| ||||||||| |  || | |||||||| ||   |||  || ||| ||||  |||| |  |  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| ||||||||| |  || | |||||||| ||   |||  || ||| ||||  |||| |  |  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| ||||||||| |  || | |||||||| ||   |||  || ||| ||||  |||| |  |  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | |||  | | | | |    |||||| ||||||||| |  || | |||||||| ||   |||  || ||| ||||  |||| |  |  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | ||\--+-+-+-+-+----++++++-/|||||||| |  || | |||||||| ||   |||  || ||| ||||  |||| |  |  |   |||  |||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | ||   | | | | |    ||||||  |||||||| | /++-+-++++++++-++---+++--++-+++-++++--++++-+--+--+---+++-\|||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | ||   | | | \-+----++++++--++++++++-+-+++-+-++++++++-++---+++--++-++/ ||||  |||| |  |  |   ||| ||||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | ||   | | |   |    ||||||  |||||||| | ||| | |||||||| || /-+++--++-++--++++--++++-+--+-\|   ||| ||||| |||    ||||   | |  ||| ||| ||||| ||  |
| || |||| | ||   | | |   |    \+++++--++++++++-+-+++-+-++++++++-++-+-+++--++-++--++++--++++-+--+-++---+++-+++++-+++----+/||   | |  ||| ||| ||||| ||  |
| || |||| | ||/--+-+-+---+\    |||||  |||||||| \-+++-+-++/||||| || | |||  || ||  ||||  |||| |  | ||   ||| ||||| |||    | |\---+-+--+++-+++-++++/ ||  |
| || |||| | |||  | | |   v|    |||||  ||||||||   ||| | || ||||| ||/+-+++--++-++--++++--++++-+--+-++--\||| ||||| |||    | |    | |  ||| ||| ||||  ||  |
|/++-++++-+-+++--+-+-+---++----+++++--++++++++---+++-+-++-+++++-++++-+++--++-++--++++--++++-+--+-++--++++\||||| |||    | |    | |  ||| ||| ||||  ||  |
|||| |||| | |||  | | |   ||    |||||  |^||||||   |||/+-++-+++++-++++\|||  |\-++--++++--++++-+--+-++--++++++++++-+++----+-+----+-+--+++-/|| ||||  ||  |
|||| |||| | |||  | | |/--++----+++++--++++++++---+++++-++-+++++-++++++++--+--++--++++--++++-+--+-++--++++++++++-+++----+\|    | |  |||  || ||||  ||  |
|||| |||| | |||  |/+-++--++-\  |||||  ||||||||   ||||| \+-+++++-++++++++--+--++--++++--++++-+--+-++--++++++++++-+++----+++----/ |  |||  || ||||  ||  |
|||| |||| | |||  ||| ||  || |  |||||/-++++++++---+++++--+-+++++-++++++++--+--++>-++++--++++-+--+-++-\|||||||||| |||    |||      |  |||  || ||||  ||  |
|||| |||| | |||  ||| ||  || |  |||||| ||||||||   |||||  | ||||| ||||||||  |  ||  ||||  |||| |  | || ||||||||||| |||   /+++------+--+++--++-++++-\||  |
|v|| |||| | |||  ||| ||  || |  |||||| ||||||||   |||||  | ||||| ||||||||  |  ||  ||||  |||| |  | || ||||||||||| |||   ||||      |  |||  || |||| |||  |
|||\-++++-+-+++--+++-++--++-+--++++++-/|||||||   |||||  | |||||/++++++++--+--++--++++-\|||| |  | || ||||||||||| |||   ||||      |  |||  || |||| |||  |
|||  |||| | |||/-+++-++--++-+--++++++--+++++++---+++++-\| ||||||||||||||  |  ||  |||| ||||| |  | || |||||||\+++-+++---++++------+--+++--++-++++-+/|  |
|||  |||| | |||| ||| ||  \+-+--++++++--+++++++---+++++-++-++/|||||||||||  | /++--++++-+++++-+--+-++-+++++++-+++-+++---++++-----\|  |||  || |||| | |  |
|||  |||| | |||| ||| ||   | |  ||||||  |||||||   ||||| || || |||||||||||  | |||  |||| ||||| |  | ||/+++++++-+++-+++--\||||     ||  |||  || |||| | |  |
||| /++++-+-++++-+++\||   | |  \+++++--+++++++---+++++-++-++-+++++++++++--+-+++--++++-+++++-+--+-++++++/||| ||| |||  |||||  /--++--+++\ || |||| | |  |
||| ||||| \-++++-++++++---+-+---/||||  |||||||   ||||| || || |||||||v|||  | |||  |||| ||||| |  | |\++++-+++-+/| |||  |||||  |  ||  |||| || |||| | |  |
|\+-+++++---++++-++++++---+-+----++++--+++++++---+++++-++-++-+++++++++++--+-+++--++++-+++++-+--+-+-++++-+/| | | |||  |||||  |  ||  |||| || |||| | |  |
| | |||||   |||| ||||||   | |    ||||  |||||||   ||||| || || |||||||||||  | |||  \+++-+++++-+--+-+-++++-+-+-+-+-+++--++++/  |  ||  |||| || |||| | |  |
| | |||||   |||| ||||||   | |    ||||  |||||||   ||||| || || |||||||||||  | |||   |||/+++++-+--+-+-++++-+-+-+-+-+++--++++---+--++\ |||| || |||| | |  |
| | |||||   |||| ||||||   | |    ||||  |||||\+---+++++-++-++-+++++++++++--+-+++---+++++++++-+--+-+-++++-+-+-+-+-+++--++++---+--+++-++++-++-+/|| | |  |
| | |||||   |||| ||||||   | |/---++++--+++++-+---+++++-++-++-+++++++++++--+-+++---+++++++++-+--+-+-++++-+-+-+-+-+++--++++---+\ ||| |||| || | || | |  |
| | |||||   |||| ||||||   | ||/--++++--+++++-+---+++++-++-++-+++++++++++--+-+++-\ ||||||||| |  | | |||| | | | | |\+--++++---++-+++-+/|| || | || | |  |
| | |||||   |||| ||||||   | |||  ||||  ||||| |   ||||| || || |||||||||||  | ||| | ||||||\++-+--+-+-++++-+-+-+-+-+-+--++++---++-+/| | || || | || | |  |
| | |||||   |||| ||||||   | |||  ||||  ||||| |   ||||| || || |||||||||||  | ||| | |^|||| |\-+--+-+-++++-+-+-+-+-+-+--++++---++-+-+-+-/| || | || | |  |
| | |||||   |||| ||||||   | |||  ||||  ||||| |   ||||| || || ||||||||||| /+-+++-+-++++++-+--+--+-+-++++-+-+-+-+-+-+--++++---++-+-+-+--+-++-+-++-+\|  |
| | |||||   |\++-++++++---+-+++--++++--+++++-+---+++++-++-++-+++++++++++-++-+++-+-/||||| |  |  | | |||| | | | | | |  ||||   || | | |  | || | || |||  |
| | |||||   | || ||||||   | |||  ||||  ||||| |   ||||| || || ||||||||||| || ||| |  ||||| |  |  | | |||| | | | | | |  ||||   \+-+-+-+--/ || | || |||  |
| | \++++---+-++-+++/||   | |||  ||||  ||||| |   ||||| || || ||||||||||| || ||| |  ||||| |  |  | | |||| | | | | | |  ||||    | | | |    || | || |||  |
| |  ||||   | || ||| ||   | |||  ||||  ||||| |   ||||| || ||/+++++++++++-++-+++-+--+++++-+--+--+-+-++++-+-+-+-+-+-+--++++----+\| | |    || | || |||  |
| | /++++---+-++-+++\||/--+-+++--++++--+++++-+---+++++-++\||||||||||||\+-++-+++-+--+++++-+--+--+-+-+++/ | | | | | |  ||||    ||| | |    || | || |||  |
| | |||||   | || ||||||| /+-+++--++++--+++++-+---+++++-+++++++++++++++-+-++-+++-+\ ||||| |  |  | | |||  | | | | | |  ||||    ||| | |    || | || |||  |
|/+-+++++--\| || |||||||/++-+++--++++-\||||| |   ||||| ||||||||||||||| | || ||| || \++++-+--+--+-+-+++--+-+-+-+-+-+--++++----+++-+-+----++-+-++-+++--/
||| ||||\--++-++-++++++++++-+++--++++-++++++-+---+++++-+++++++++++++++-+-++-+++-++--++++-+--+--+-+-+++--/ | | | | |  |\++----+++-+-+----++-+-++-/||   
||| ||||   || || ||||\+++++-+++--++++-++++++-+---++/|| ||||||||||||||| | || ||| ||  |||| |  |  | | |||    | | | | |  | ||    ||| | |    || | ||  ||   
||| ||||   || || |||| ||||| |||  |||| |||||| |   || || ||||||||||||||| | || ||| ||  |||| |  |  | | |||    | | | | |  | ||   /+++-+-+---\|| | ||  ||   
||| ||||   || || |||| ||||| |||  ||||/++++++-+---++-++-+++++++++++++++-+-++-+++-++--++++-+--+--+-+-+++----+-+-+-+-+--+-++->-++++\| |   ||| | ||  ||   
||| ||||   || || |||| ||||| |||  ||||||||||| |   ||/++-+++++++++++++++-+-++-+++-++--++++-+--+--+-+-+++----+-+-+-+-+--+-++---++++++-+---+++-+-++--++-\ 
||| ||||   || || |||| ||||| |||  ||||||||||| |   ||||| |||||\+++++++++-+-++-+++-++--++++-+--+--+-+-+++----+-+-+-+-+--+-++---++/||| |   ||| | ||  || | 
||| ||||   || || |||| ||||| |||  ||||||||||| |   ||||\-+++++-+++++++++-+-++-+++-++--++++-+--+--+-+-+++----+-+-+-+-+--+-++---++-+++-/   ||| | ||  || | 
||| ||||   || || |||| ||||| |||  \++++++++/| |   ||||  ||||| ||||||||| | ||/+++-++--++++-+--+-\| | |||    | | | | |  | ||/--++-+++---\ ||| | ||  || | 
||| ||\+---++-++-++++-+++++-+++---/||||||| | |   ||||  ||||| ||||||||| | |||||| ||  |||| |  | || | |||    | | | | |  | |||  || |||   | ||| v ||  || | 
||| |\-+---++-++-++++-+++++-+++----+++++++-+-+---++++--+++++-+++++++++-+-++++++-++--++++-+--/ || | |||    | | | | |  | |||  || |||   | ||| | ||  || | 
||| |  |   || || |v|| ||||| |||    ||||||| | |   ||||  ||||| ||||||||| | \+++++-++--++++-+----++-+-+++----+-+-+-+-+--+-+++--++-+++---+-+++-+-++--/| | 
||| |  |   || || |||| ||||| |||    ||||||| | |   ||||  ||||| ||||\++++-+--+++++-++--++++-+----++-+-+++----+-+-+-+-+--+-/||  || |||   | ||| | ||   | | 
||| \--+---++-++-+++/ ||||| |||    ||||||| | |   ||||  |||\+-++++-++++-+--+++++-++--+++/ |    || | |||    | | | | |  |  ||  || |||   | ||| | ||   | | 
|||    |   || || |||  |||\+-+++----+++++++-+-+---++++--+++-+-++++-++++-+--+++++-+/ /+++--+----++-+-+++----+-+-+-+-+--+--++--++-+++---+-+++-+\||   | | 
|||    | /-++-++-+++--+++-+-+++----+++++++-+-+---++++--+++-+-++++-++++-+--+++++-+--++++--+----++-+-+++----+-+-+\| |  |  ||  || |||   | ||| ||||   | | 
|||    | | || || |||  ||| | |||    ||||||| | \---++++--+++-+-++++-++++-+--+++++-+--++++--/    || | |||    | | ||| |  |  ||  || |||   | ||| ||||   | | 
|||    | | || || |||  ||| | v||/---+++++++-+-----++++-\||| | |||| |||| |  ||||\-+--++++-------++-+-+++----+-+-+++-+--+--++--++-+++---+-+++-++/|   | | 
|||    | | |\-++-+++--+++-+-++++---++++++/ |     |||| |||| | |\++-++++-+--+++/  |/-++++-------++-+-+++----+-+-+++-+--+-\||  || |||   | ||| || |   | | 
|||    | | |  || |||  ||| | ||\+---++++++--+-----++++-++++-+-+-++-++++-+--+++---/| ||||       || |/+++--->+-+-+++-+--+-+++--++\|||   | ||| || |   | | 
|||    | | |  || |||  ||| | || |   ||||||  |     |||| |||| | | || |||| |  |||    | ||||       || |||^|  /-+-+-+++-+--+-+++--++++++---+-+++-++-+---+\| 
|||    | | |  || |||  ||| | || |   ||||||  |     |||| ||\+-+-+-++-++++-+--+++----+-++++-------++-+++++--+-+-+-+++-+--+-+++--++++++---+-+++-++-+---/|| 
|||    | | |  || |||  ||| | || |   |||||\--+-----++++-++-+-+-+-++-++++-+--+++----+-++++-------++-+++++--+-+-+-/|| |  | |||  ||||||   | ||| || |    || 
|||    | | |  || |||  ||| | || |   |||||   |     \+++-++-+-+-+-++-++++-+--+++----+-++++-------++-+++++--+-/ |  || |  | |||  ||||||/--+-+++-++-+-\  || 
|||    | | |  || |||  ||| | || |   |||||   |      ||| || | | | || |||| \--+++----+-++++-------++-+++++--+---+--+/ |  | |||  |||||||  | ||| || | |  || 
|||    |/+-+--++-+++--+++-+-++-+---+++++--\|      ||| || | | | || ||||    |||    | |\++-------++-+++++--+---+--+--/  | |||  |||||||  | ||| || | |  || 
|||    ||| |  || |||  ||| | || |   |||||  ||      ||| || | | | || \+++----+++----+-+-++-------++-++++/  |   |  |     | |||  |||||||  | ||| || | |  || 
|||    ||| |  ||/+++--+++-+-++-+---+++++--++------+++-++-+-+-+-++--+++----+++----+-+-++-------++-++++---+---+--+-----+\|||  \++++++--+-/|| || | |  || 
|||    ||| |  ||||||  ||| | || |   |||||  ||      |\+-++-+-+-+-++--+++----+++----+-+-++-------++-++++---+---+--+-----+++++---++++++--+--++-++-+-+--+/ 
|||    ||| |  ||||||  ||| | || |   |||||  ||      | | || | | | ||  |||    \++----+-+-++-------++-++++---+---+--+-----+++++---++++++--+--+/ || | |  |  
|||    ||| |  ||||||  ||| | || \---+++++--++------+-+-/| | | | ||  |||     ||    | | ||       || ||||   |   |  |     |||||   ||||||  |  |  || | |  |  
|||    ||| |  |||||\--+++-+-++-----+++++--++------+-+--+-+-+-/ ||  |||     ||    | | \+-------++-++++---+---+--+-----+++++---++++/|  |  |  || | |  |  
|||    ||| |  |||||  /+++-+-++-----+++++--++------+-+--+-+-+---++--+++-----++----+-+--+----\  || ||||   |   |  |     |||||   |||| |  |  |  || | |  |  
|||    ||| |/-+++++--++++-+-++-----+++++--++------+-+--+-+-+---++--+++----\||    | |  |    |  || ||||   |   |  |     |||||   |||| |  |  |  || | |  |  
||\----+++-++-+++++--++++-+-++-----+++++--++------+-+--+-+-+---++--++/    |||    | |  |    |  || ||||   |   |  |     |||||   |||| |  |  |  || | |  |  
||     |||/++-+++++--++++-+-++-\   |||||  ||      | |  | | \---++--++-----+++----+-+--+----+--++-++++---+---+--+-----+++++---++++-+--+--/  || | |  |  
||     |||||| |||||  |||| | || |   |||||  ||      \-+--+-+-----++--++-----+++----+-+--+----+--++-++++---+---+--+-----+++++---++++-+--+-----/| | |  |  
||     |||||| |||||  |||| | || |   |||||  ||        |  | |     ||  ||     |||    | |  |    |  || ||||   |   |  |     |||||   |||| |  |      | | |  |  
||     |||||| |||||  |||| | || |   ||\++--++--------+--+-+-----++--++-----+++----+-+--+----+--++-++++---+---+--+-----+++++---+++/ |  |      | | |  |  
||     ||\+++-+++++--++++-+-++-+---++-++--++--------+--+-+-----++--++-----+++----+-+--+----+--++-++++---+---+--/     |||||   |||  |  |      | | |  |  
||     || ||| |||\+--++++-+-++-+---++-++--++--------+--+-+-----++--++-----+++----+-+--+----+--++-++++---+---/        |||||   |||  |  |      | | |  |  
|\-----++-+/| ||| |  |||| | || |   || ||  ||        |  | |     ||  ||  /--+++----+-+--+----+\ || ||||   \------------+++++---+++--+--+------+-+-+--/  
|      || | | ||| \--++++-+-/| |   || ||  ||        |  | |     ||  ||  |  |||    | \--+----++-++-++++----------------+++++---+++--+--+------/ | |     
|      || | | |\+----++++-+--+-+---++-++--++--------+--/ |     ||  ||  |  ||\----+----+----++-++-++++----------------+++++---++/  |  |        | |     
|      || | | | |    |||| |  | |   |\-++--++--------+----+-----++--++--+--++-----+----+----++-++-+++/                |||||   ||   |  |        | |     
|      || | | | |    |||\-+--+-+---+--/|  ||        |    |     ||  ||  |  ||     |    |    || || ||\-----------------/||||   ||   |  |        | |     
|      || | | \-+----+++--/  | |   |   |  ||        |    |     ||  ||  |  ||     |    |    || || ||                   ||||   ||   |  |        | |     
|      || \-+---+----+++-----+-/   |   |  ||        |    |     \+--++--+--++-----+----/    || || ||                   ||||   ||   |  |        | |     
|      |\---+---+----+++-----+-----+---+--/|        |    |      \--++--+--++-----+---------++-++-++-------------------++++---++---+--+--------/ |     
|      |    |   |    |\+-----+-----+---+---+--------+----+---------++--+--++-----+---------++-++-++-------------------++/\---++---+--/          |     
|      |    |   |    \-+-----+-----+---+---+--------+----+---------++--+--++-----+---------/| || ||                   ||     ||   |             |     
|      |    |   |      |     |     |   |   |        |    |         ||  |  ||     |          | || ||                   ||     ||   |             |     
\------+----+---+------+-----+-----/   |   |        |    |         ||  |  ||     \----------+-++-++-------------------+/     ||   |             |     
       |    |   |      |     \---------+---+--------+----+---------++--+--++----------------+-++-++-------------------+------/|   |             |     
       |    |   |      \---------------+---+--------+----/         ||  |  ||                | || ||                   |       |   |             |     
       |    |   |                      |   |        |              ||  |  |\----------------+-/| ||                   |       |   |             |     
       |    |   |                      |   |        \--------------+/  \--+-----------------/  | ||                   |       |   \-------------/     
       |    |   |                      |   |                       \------+--------------------+-/|                   |       |                       
       |    |   |                      \---+------------------------------+--------------------/  |                   |       |                       
       \----+---+--------------------------/                              |                       \-------------------+-------/                       
            \---+---------------------------------------------------------/                                           |                               
                \-----------------------------------------------------------------------------------------------------/                               ";
    }
}
